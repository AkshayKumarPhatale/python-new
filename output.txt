




















bteq <<EOF







.SET WIDTH 150;


.SET SESSION TRANSACTION BTET;






.run file $LOGON/$LOGON_ID;

.IF ERRORCODE <> 0 THEN .GOTO ERRORS





SELECT SESSION;


.IF ERRORCODE <> 0 THEN .GOTO ERRORS




.IF ERRORCODE <> 0 THEN .GOTO ERRORS







DATABASE $ETL_VIEWS_DB;



.IF ERRORCODE <> 0 THEN .GOTO ERRORS

create multiset volatile table SML_TRIMED_WORK as
(
SELECT
DISTINCT
CAST(TRIMED_CASE_ID AS VARCHAR(25)) AS V_TRI_CASE_ID
,C_PGM_IND
FROM LZ_TRIMED_AIM_PROD_CD_WORK)
with data
on commit preserve rows;


.IF ERRORCODE <> 0 THEN .GOTO ERRORS



Collect statistics column(V_TRI_CASE_ID) on SML_TRIMED_WORK ;


.IF ERRORCODE <> 0 THEN .GOTO ERRORS


UPDATE UM_RQST
FROM SML_TRIMED_WORK B
SET AIM_PROD_CD = B.C_PGM_IND
,CRCTD_LOAD_LOG_KEY = (SEL CRCTD_LOAD_LOG_KEY FROM CRCTD_LOAD_LOG
WHERE LOAD_END_DTM = '8888-12-31 12:00:00.000000'
AND CRCTD_PBLSH_IND='N'
AND CRCTD_PBLSH_DTM='8888-12-31 12:00:00.000000'
AND CRCTD_DESC_TXT='$CRCTD_DESC_TXT')
WHERE RFRNC_NBR = B.V_TRI_CASE_ID
WHERE CLNCL_SOR_CD = '870'
AND AIM_PROD_CD <> 'MSK'
;



.IF ERRORCODE <> 0 THEN .GOTO ERRORS



.QUIT 0










.LABEL ERRORS

.QUIT ERRORCODE

EOF














